"use strict";(self.webpackChunkwppconnect_team_github_io=self.webpackChunkwppconnect_team_github_io||[]).push([[47606],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>g});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=c(a),m=o,g=d["".concat(l,".").concat(m)]||d[m]||u[m]||r;return a?n.createElement(g,s(s({ref:t},p),{},{components:a})):n.createElement(g,s({ref:t},p))}));function g(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,s=new Array(r);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[d]="string"==typeof e?e:o,s[1]=i;for(var c=2;c<r;c++)s[c]=a[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},13397:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var n=a(87462),o=(a(67294),a(3905));const r={sidebar_position:2},s="Criando um Cliente",i={unversionedId:"tutorial/basics/creating-client",id:"tutorial/basics/creating-client",title:"Criando um Cliente",description:"Para come\xe7ar a usar Wppconnect Bot, voc\xea precisa criar um arquivo e chamar o m\xe9todo {@link create}.\\",source:"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/tutorial/basics/creating-client.md",sourceDirName:"tutorial/basics",slug:"/tutorial/basics/creating-client",permalink:"/pt-BR/docs/tutorial/basics/creating-client",draft:!1,editUrl:"https://github.com/wppconnect-team/wppconnect-team.github.io/tree/main/docs/tutorial/basics/creating-client.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docs",previous:{title:"Instala\xe7\xe3o",permalink:"/pt-BR/docs/tutorial/basics/installation"},next:{title:"Recebendo Mensagens",permalink:"/pt-BR/docs/tutorial/basics/receiving-messages"}},l={},c=[{value:"Sess\xf5es m\xfaltiplas",id:"sess\xf5es-m\xfaltiplas",level:2},{value:"Passado op\xe7\xf5es ao criar",id:"passado-op\xe7\xf5es-ao-criar",level:2},{value:"Callback de Status de Sess\xe3o",id:"callback-de-status-de-sess\xe3o",level:3},{value:"Verifica\xe7\xe3o de conex\xe3o telef\xf4nica",id:"verifica\xe7\xe3o-de-conex\xe3o-telef\xf4nica",level:3},{value:"Exportando QR Code",id:"exportando-qr-code",level:3},{value:"Salvando o Token da Sess\xe3o",id:"salvando-o-token-da-sess\xe3o",level:3},{value:"Multidispositivo (BETA)",id:"multidispositivo-beta",level:3}],p={toc:c},d="wrapper";function u(e){let{components:t,...a}=e;return(0,o.kt)(d,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"criando-um-cliente"},"Criando um Cliente"),(0,o.kt)("p",null,"Para come\xe7ar a usar ",(0,o.kt)("inlineCode",{parentName:"p"},"Wppconnect Bot"),", voc\xea precisa criar um arquivo e chamar o m\xe9todo {@link create}.\\\nEsse m\xe9todo retorna uma ",(0,o.kt)("inlineCode",{parentName:"p"},"Promessa")," de {@link Whatsapp}."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// Suporta ES6\n// import { create, Whatsapp } from '@wppconnect-team/wppconnect';\nconst wppconnect = require('@wppconnect-team/wppconnect');\n\nwppconnect\n  . reate()\n  .then((cliente) => start(cliente))\n  .catch((error) => console.log(erro));\n")),(0,o.kt)("h2",{id:"sess\xf5es-m\xfaltiplas"},"Sess\xf5es m\xfaltiplas"),(0,o.kt)("p",null,"Se voc\xea deseja come\xe7ar mais de uma sess\xe3o, por exemplo, caso voc\xea tenha diferentes departamentos em seu projeto, ent\xe3o voc\xea teve que especific\xe1-lo em seu c\xf3digo, como nesse exemplo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// Inicia vendas whatsapp bot\nwppconnect.create({session: 'sales'}).then((cliente) => startClient(cliente));\n\n// Inicia suporte a whatsapp bot\nwppconnect.create({session: 'support'}).then((client) => startSupport(cliente));\n")),(0,o.kt)("h2",{id:"passado-op\xe7\xf5es-ao-criar"},"Passado op\xe7\xf5es ao criar"),(0,o.kt)("p",null,"O terceiro par\xe2metro do m\xe9todo {@link create} pode ter os seguintes par\xe2metros opcionais (veja todos os par\xe2metros em {@link CreateOptions}):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"wppconnect. reate({\n    sess\xe3o: 'sessionName', //Passe o nome do cliente que voc\xea deseja iniciar o bot\n    catchQR: (base64Qrimg, asciiQR, attempts, urlCode) => {\n      console. og('N\xfamero de tentativas para ler o console qrcode: ', tentativas);\n      og('C\xf3digo de terminal: ', asciiQR);\n      console.log('qrcode de string de imagem base64 ', base64Qrimg);\n      console. og('urlCode (data-ref): ', urlCode);\n    },\n    statusFind: (statusSession, sess\xe3o) => {\n      console. og('Sess\xe3o de status: ', statusSess\xe3o); //return est\xe1 logado \u2122\ufe0fs n\xe3o est\xe1 logado/no navegador. Fechamento &qrReadSuccess \u251cqrReadFail \u300cAutocloseCalled \u300cdesconectadaMobile \u251cdeleteToken\n      ///criar sess\xe3o wss return servidor \"serverClose\" para fechar\n      console. og('Nome da sess\xe3o: ', sess\xe3o);\n    },\n    headless: true, // Chrome sem cabe\xe7a\n    devtools: false, false, // Abrir devtools por padr\xe3o\n    useChrome: true, // Se falso ir\xe1 usar a inst\xe2ncia do Chromium\n    depurador: false, // Abre uma sess\xe3o de depura\xe7\xe3o\n    logQR: true, // Registra o QR automaticamente no terminal\n    browserWS: '', // Se voc\xea quiser usar o browserWSEndpoint\n    browserArgs: [''], // Par\xe2metros a serem adicionados para a inst\xe2ncia do navegador chrome\n    puppeteerOptions: {}, // Ser\xe1 passado para puppeteer. aperte\n    desabilita: falso, // Op\xe7\xe3o para desativar a mensagem de boas-vindas que aparece no come\xe7o\n    atualiza\xe7\xf5esLog: verdadeiro, // Atualiza automaticamente as informa\xe7\xf5es no terminal\n    autoClose: 60000, // Automaticamente fecha o wppconnect apenas ao escanear o c\xf3digo QR (padr\xe3o 60 segundos, se voc\xea quiser desativ\xe1-lo, atribuir 0 ou falso)\n    tokenStore: 'file', // Defina como funciona com tokens, que pode ser uma interface personalizada\n    folderNameToken: '. tokens', //folder nome ao salvar tokens\n    // BrowserSessionToken\n    // Para receber o token do cliente use a fun\xe7\xe3o await clinet. etSessionTokenBrowser()\n    sessionToken: {\n      WABrowserId: '\"UnXjH. ...\"',\n      WASecretBundle: '{\"chave\":\"+i/nRgWJ. ..\",\"encKey\":\"kGdMR5t......\",\"macKey\":\"+i/nRgW......\"}',\n      WAToken1: '\"0i8....\"',\n      WAToken2: '\"1@lPzwC.... ',\n    }\n  })\n  . hen((cliente) => start(cliente))\n  .catch((error) => console.log(erro));\n")),(0,o.kt)("h3",{id:"callback-de-status-de-sess\xe3o"},"Callback de Status de Sess\xe3o"),(0,o.kt)("p",null,"Mais detalhes em {@link StatusFind}"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Status"),(0,o.kt)("th",{parentName:"tr",align:null},"Condi\xe7\xe3o"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"isLogged")),(0,o.kt)("td",{parentName:"tr",align:null},"Quando o usu\xe1rio j\xe1 estiver logado no navegador")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"notLogged")),(0,o.kt)("td",{parentName:"tr",align:null},"Quando o usu\xe1rio n\xe3o estiver conectado ao navegador, \xe9 necess\xe1rio ler o c\xf3digo QR atrav\xe9s do celular na op\xe7\xe3o WhatsApp Web")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"browserClose")),(0,o.kt)("td",{parentName:"tr",align:null},"Se o navegador \xe9 fechado este par\xe2metro \xe9 retornado")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"qrReadSuccess")),(0,o.kt)("td",{parentName:"tr",align:null},"Se o usu\xe1rio n\xe3o estiver conectado, o c\xf3digo QR \xe9 passado no terminal um callback \xe9 retornado. Depois da leitura correta por telefone celular, este par\xe2metro \xe9 retornado")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"qrReadFail")),(0,o.kt)("td",{parentName:"tr",align:null},"Se o navegador parar quando a verifica\xe7\xe3o do c\xf3digo QR estiver em andamento, este par\xe2metro ser\xe1 retornado")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"autocloseCalled")),(0,o.kt)("td",{parentName:"tr",align:null},"O navegador foi fechado usando o comando AutoClose")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"desconnectedMobile")),(0,o.kt)("td",{parentName:"tr",align:null},"O cliente se desconectou ao celular")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"serverClose")),(0,o.kt)("td",{parentName:"tr",align:null},"O cliente se desconectou ao celular")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"deleteToken")),(0,o.kt)("td",{parentName:"tr",align:null},"Se voc\xea passar true dentro da fun\xe7\xe3o ",(0,o.kt)("inlineCode",{parentName:"td"},"client.getSessionTokenBrowser(true)"))))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const wppconnect = require('@wppconnect-team/wppconnect');\nwppconnect\n  . reate({\n    sess\xe3o: 'sessionName',\n    statusFind: (statusSession, sess\xe3o) => {\n      // retorna: isLogged \u251cnotLogged \u251c\u251cbrowser. Close qrReadSuccess \u251cqrReadFail \u251c\u251cautocloseCalled \u251cdesconnectedMobile \u251cdeleteToken\n      console. og('Sess\xe3o de status: ', statusSess\xe3o);\n      // cria sess\xe3o wss return \"serverClose\" case server for close\n      console. og('Nome da sess\xe3o: ', sess\xe3o);\n    },\n  })\n  . hen((cliente) => start(cliente))\n  .catch((error) => console.log(erro));\n")),(0,o.kt)("h3",{id:"verifica\xe7\xe3o-de-conex\xe3o-telef\xf4nica"},"Verifica\xe7\xe3o de conex\xe3o telef\xf4nica"),(0,o.kt)("p",null,"Para garantir a verifica\xe7\xe3o de conex\xe3o do telefone, use o c\xf3digo abaixo ou verifique a documenta\xe7\xe3o {@link Whatsapp.startPhoneWatchdog}.:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// Para iniciar com o intervalo padr\xe3o.\nclient.startPhoneWatchdog();\n\n// Para come\xe7ar com um intervalo personalizado.\nclient.startPhoneWatchdog(30000); // 30s\n\n// Para parar.\nclient.stopPhoneWatchdog();\n")),(0,o.kt)("h3",{id:"exportando-qr-code"},"Exportando QR Code"),(0,o.kt)("p",null,"Por padr\xe3o, o QR code aparecer\xe1 no terminal. Se voc\xea precisar passar o QR em algum outro lugar, (veja {@link CatchQRCallback}):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const fs = require('fs');\nconst wppconnect = require('@wppconnect-team/wppconnect');\n\nwppconnect\n  .create({\n    session: 'sessionName',\n    catchQR: (base64Qr, asciiQR) => {\n      console.log(asciiQR); // Optional to log the QR in the terminal\n      var matches = base64Qr.match(/^data:([A-Za-z-+\\/]+);base64,(.+)$/),\n        response = {};\n\n      if (matches.length !== 3) {\n        return new Error('Invalid input string');\n      }\n      response.type = matches[1];\n      response.data = new Buffer.from(matches[2], 'base64');\n\n      var imageBuffer = response;\n      require('fs').writeFile(\n        'out.png',\n        imageBuffer['data'],\n        'binary',\n        function (err) {\n          if (err != null) {\n            console.log(err);\n          }\n        }\n      );\n    },\n    logQR: false,\n  })\n  .then((client) => start(client))\n  .catch((error) => console.log(error));\n")),(0,o.kt)("h3",{id:"salvando-o-token-da-sess\xe3o"},"Salvando o Token da Sess\xe3o"),(0,o.kt)("p",null,"Leia o {@link TokenStore}"),(0,o.kt)("h3",{id:"multidispositivo-beta"},"Multidispositivo (BETA)"),(0,o.kt)("p",null,"Para usar a conta multidispositivo, voc\xea precisa configurar um diret\xf3rio de dados fixo para o navegador mant\xea-lo logado, porque o WhatsApp mudou o modo de autentica\xe7\xe3o."),(0,o.kt)("p",null,"Para configurar isso, voc\xea pode usar o exemplo abaixo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"wppconnect\n  .create({\n    // ...\n    sess\xe3o: 'mySessionName',\n    puppeteerOptions: {\n      userDataDir: './tokens/mySessionName', // ou seu diret\xf3rio personalizado\n    },\n    // ...\n  })\n  .then((cliente) => start(cliente))\n  .catch((error) => console.log(erro));\n")))}u.isMDXComponent=!0}}]);